{{ define "header" }}
<header>
  <nav
    id="navbar"
    class="fixed inset-x-0 z-20 w-full border-b border-gray-100 bg-white/80 backdrop-blur"
  >
    <div class="mx-auto px-4 sm:px-12 xl:max-w-6xl xl:px-0">
      <div
        class="relative flex flex-wrap items-center justify-between gap-4 lg:gap-0 lg:py-2"
      >
        <div class="relative z-20 flex w-full justify-between md:px-0 lg:w-max">
          <a
            href="/"
            aria-label="logo"
            class="flex items-center space-x-2 py-2"
          >
            <img
              class="w-auto h-10"
              src="https://avatars.githubusercontent.com/u/95134208?s=200&v=4"
              alt=""
            />
            <span class="font-bold text-gray-600 text-xl">ioprodz</span>
          </a>

          <button
            aria-label="humburger"
            id="hamburger"
            class="relative -mr-4 p-4 lg:hidden"
          >
            <div
              aria-hidden="true"
              class="m-auto h-0.5 w-5 rounded bg-sky-900 transition duration-300"
            ></div>
            <div
              aria-hidden="true"
              class="m-auto mt-2 h-0.5 w-5 rounded bg-sky-900 transition duration-300"
            ></div>
          </button>
        </div>
        <div
          id="layer"
          aria-hidden="true"
          class="fixed inset-0 z-10 h-screen w-screen origin-bottom scale-y-0 bg-white/70 backdrop-blur-2xl transition duration-500 lg:hidden"
        ></div>
        <div
          id="navlinks"
          class="invisible absolute top-full left-0 z-20 w-full origin-top-right translate-y-1 scale-90 flex-col flex-wrap justify-end gap-6 rounded-3xl border border-gray-100 bg-white p-8 opacity-0 shadow-2xl shadow-gray-600/10 transition-all duration-300 lg:visible lg:relative lg:flex lg:w-auto lg:translate-y-0 lg:scale-100 lg:flex-row lg:items-center lg:gap-0 lg:border-none lg:bg-transparent lg:p-0 lg:opacity-100 lg:shadow-none lg:peer-checked:translate-y-0"
        >
          <div class="text-gray-600 lg:pr-4">
            <ul
              class="flex items-center space-y-6 text-base font-medium tracking-wide lg:flex lg:space-y-0 lg:text-sm"
            >
              {{ if .isAuthenticated }}
              <li>
                <a
                  class="block transition hover:text-primary md:px-4"
                  href="/feed"
                >
                  <span>Feed</span>
                </a>
              </li>
              <li>
                <a
                  class="block transition hover:text-primary md:px-4"
                  href="/admin/qna"
                >
                  <span>Admin</span>
                </a>
              </li>

              {{ else }}
              <li>
                <a class="block transition hover:text-primary md:px-4" href="/">
                  <span>Home</span>
                </a>
              </li>

              {{ end }}

              <!-- Consulting Dropdown -->
              <li class="relative" id="consulting-menu">
                <button
                  id="consulting-trigger"
                  class="flex items-center gap-1 transition hover:text-primary md:px-4"
                  aria-expanded="false"
                  aria-haspopup="true"
                >
                  <span>Consulting</span>
                  <svg class="w-4 h-4 transition-transform duration-200" id="consulting-chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                  </svg>
                </button>

                <div
                  id="consulting-dropdown"
                  class="invisible absolute left-0 top-full z-30 mt-2 w-72 origin-top-left scale-95 rounded-xl border border-gray-100 bg-white p-2 opacity-0 shadow-xl shadow-gray-200/50 transition-all duration-200 lg:left-1/2 lg:-translate-x-1/2"
                >
                  <a href="/consulting" class="flex items-center gap-3 rounded-lg px-3 py-2.5 transition-colors hover:bg-gray-50">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-slate-100">
                      <svg class="h-4 w-4 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                    </div>
                    <div>
                      <div class="text-sm font-semibold text-gray-900">Overview</div>
                      <div class="text-xs text-gray-500">Our consulting services</div>
                    </div>
                  </a>
                  <div class="my-1 border-t border-gray-100"></div>
                  <a href="/consulting/it-strategy" class="flex items-center gap-3 rounded-lg px-3 py-2.5 transition-colors hover:bg-gray-50">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-blue-100">
                      <svg class="h-4 w-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                    </div>
                    <div>
                      <div class="text-sm font-semibold text-gray-900">IT Strategy</div>
                      <div class="text-xs text-gray-500">Roadmap, architecture & leadership</div>
                    </div>
                  </a>
                  <a href="/consulting/coaching" class="flex items-center gap-3 rounded-lg px-3 py-2.5 transition-colors hover:bg-gray-50">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-emerald-100">
                      <svg class="h-4 w-4 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                    </div>
                    <div>
                      <div class="text-sm font-semibold text-gray-900">Team & Individual Coaching</div>
                      <div class="text-xs text-gray-500">Practices, culture & growth</div>
                    </div>
                  </a>
                </div>
              </li>

              <!-- Solutions Dropdown -->
              <li class="relative" id="solutions-menu">
                <button
                  id="solutions-trigger"
                  class="flex items-center gap-1 transition hover:text-primary md:px-4"
                  aria-expanded="false"
                  aria-haspopup="true"
                >
                  <span>Solutions</span>
                  <svg class="w-4 h-4 transition-transform duration-200" id="solutions-chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                  </svg>
                </button>

                <!-- Desktop Dropdown -->
                <div
                  id="solutions-dropdown"
                  class="invisible absolute left-0 top-full z-30 mt-2 w-72 origin-top-left scale-95 rounded-xl border border-gray-100 bg-white p-2 opacity-0 shadow-xl shadow-gray-200/50 transition-all duration-200 lg:left-1/2 lg:-translate-x-1/2"
                >
                  <a href="/solutions" class="flex items-center gap-3 rounded-lg px-3 py-2.5 transition-colors hover:bg-gray-50">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-blue-100">
                      <svg class="h-4 w-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                    </div>
                    <div>
                      <div class="text-sm font-semibold text-gray-900">Platform Overview</div>
                      <div class="text-xs text-gray-500">The complete Polysee platform</div>
                    </div>
                  </a>
                  <div class="my-1 border-t border-gray-100"></div>
                  <a href="/solutions/ai-engine" class="flex items-center gap-3 rounded-lg px-3 py-2.5 transition-colors hover:bg-gray-50">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-violet-100">
                      <svg class="h-4 w-4 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
                    </div>
                    <div>
                      <div class="text-sm font-semibold text-gray-900">AI Engine</div>
                      <div class="text-xs text-gray-500">Agent runtime & orchestration</div>
                    </div>
                  </a>
                  <a href="/solutions/chat-collaboration" class="flex items-center gap-3 rounded-lg px-3 py-2.5 transition-colors hover:bg-gray-50">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-blue-100">
                      <svg class="h-4 w-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
                    </div>
                    <div>
                      <div class="text-sm font-semibold text-gray-900">Multi Modal Chat</div>
                      <div class="text-xs text-gray-500">AI-native messaging</div>
                    </div>
                  </a>
                  <a href="/solutions/collaborative-editing" class="flex items-center gap-3 rounded-lg px-3 py-2.5 transition-colors hover:bg-gray-50">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-emerald-100">
                      <svg class="h-4 w-4 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                    </div>
                    <div>
                      <div class="text-sm font-semibold text-gray-900">Collaborative Editing</div>
                      <div class="text-xs text-gray-500">Real-time document editing</div>
                    </div>
                  </a>
                  <a href="/solutions/search-rag" class="flex items-center gap-3 rounded-lg px-3 py-2.5 transition-colors hover:bg-gray-50">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-amber-100">
                      <svg class="h-4 w-4 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </div>
                    <div>
                      <div class="text-sm font-semibold text-gray-900">Search & RAG</div>
                      <div class="text-xs text-gray-500">Semantic search & retrieval</div>
                    </div>
                  </a>
                </div>
              </li>

              <li>
                <a
                  class="block transition hover:text-primary md:px-4"
                  href="/blog"
                >
                  <span>Blog</span>
                </a>
              </li>
              {{ if .isAuthenticated }}
              <li>
                <a href="/profile">
                  <img
                    class="w-9 rounded-full"
                    src="{{ .user.AvatarUrl }}"
                    alt=""
                  />
                </a>
              </li>
              {{ end }}
            </ul>
          </div>
        </div>
        <div class="fixed top-3 right-14 z-20 sm:right-24 lg:hidden">
          <button
            aria-label="switche theme"
            class="switcher group relative flex h-9 w-9 rounded-full before:absolute before:inset-0 before:rounded-full before:border before:border-gray-200 before:bg-gray-50 before:bg-gradient-to-b before:transition-transform before:duration-300 hover:before:scale-105 active:duration-75 active:before:scale-95"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="transistion relative m-auto hidden h-5 w-5 fill-gray-500 duration-300 group-hover:rotate-180 group-hover:fill-yellow-400"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path
                fill-rule="evenodd"
                d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                clip-rule="evenodd"
              ></path>
            </svg>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="transistion relative m-auto h-5 w-5 fill-gray-500 duration-300 group-hover:-rotate-90 group-hover:fill-blue-900"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path
                d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
              ></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
(function() {
  function initDropdown(prefix) {
    const trigger = document.getElementById(prefix + '-trigger');
    const dropdown = document.getElementById(prefix + '-dropdown');
    const chevron = document.getElementById(prefix + '-chevron');
    const menu = document.getElementById(prefix + '-menu');
    if (!trigger || !dropdown) return null;

    let isOpen = false;
    let closeTimeout;

    function open() {
      clearTimeout(closeTimeout);
      if (isOpen) return;
      isOpen = true;
      dropdown.classList.remove('invisible', 'opacity-0', 'scale-95');
      dropdown.classList.add('visible', 'opacity-100', 'scale-100');
      chevron.style.transform = 'rotate(180deg)';
      trigger.setAttribute('aria-expanded', 'true');
    }

    function close() {
      if (!isOpen) return;
      isOpen = false;
      dropdown.classList.add('invisible', 'opacity-0', 'scale-95');
      dropdown.classList.remove('visible', 'opacity-100', 'scale-100');
      chevron.style.transform = 'rotate(0deg)';
      trigger.setAttribute('aria-expanded', 'false');
    }

    function scheduleClose() {
      closeTimeout = setTimeout(close, 150);
    }

    menu.addEventListener('mouseenter', open);
    menu.addEventListener('mouseleave', scheduleClose);

    trigger.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      if (isOpen) { close(); } else { open(); }
    });

    return { menu: menu, close: close };
  }

  var dropdowns = [initDropdown('consulting'), initDropdown('solutions')].filter(Boolean);

  document.addEventListener('click', function(e) {
    dropdowns.forEach(function(d) {
      if (!d.menu.contains(e.target)) { d.close(); }
    });
  });

  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      dropdowns.forEach(function(d) { d.close(); });
    }
  });
})();
</script>
{{ end }}
